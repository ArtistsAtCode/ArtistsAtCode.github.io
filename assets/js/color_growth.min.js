let colorGrowth=function(e,o,t,n,f){const r=t||Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);return[function(t){class a{constructor(){this.head=null,this.tail=null,this.size=0}enqueue(e){let o={value:e,next:null};this.head?(this.tail.next=o,this.tail=o):(this.head=o,this.tail=o),this.size+=1}dequeue(){if(!this.head)return null;const e=this.head;return this.head===this.tail&&(this.tail=null),this.head=this.head.next,this.size-=1,e.value}items(){let e=new Array,o=this.head;for(;o;)e.push(o),o=o.next;return e}}class l{constructor(e,o){this.x=e,this.y=o}}class d{constructor(e,o,t){this.red=e,this.green=o,this.blue=t}}class s{constructor(){this.unmutated=!0,this.waitingToBePainted=!1,this.myColor=void 0,this.potentialOrphan=!1}mutateColor(e,o){this.unmutated=!1;let t=this.myColor?this.myColor.red:-1,n=this.myColor?this.myColor.green:-1,f=this.myColor?this.myColor.blue:-1,r=h(e,o);return t+=r.red,n+=r.green,f+=r.blue,t=c(t,0,255),n=c(n,0,255),f=c(f,0,255),this.myColor=new d(t,n,f),be&&(this.myColor=i(this.myColor)),this.myColor}blendColor(e,o){this.unmutated=!1;const t=(e.red+o.red)/2,n=(e.green+o.green)/2,f=(e.blue+o.blue)/2;return this.myColor=new d(t,n,f),this.myColor}addColors(e,o){const t=c(e.red+o.red,0,255),n=c(e.green+o.green,0,255),f=c(e.blue+o.blue,0,255);return this.myColor=new d(t,n,f),this.myColor}updateColor(e){return this.unmutated=!1,this.myColor=e,this.myColor}refreshNode(){this.unmutated=!0,this.waitingToBePainted=!1,this.potentialOrphan=!1}}function c(e,o,t){return Math.max(Math.min(e,Math.max(o,t)),Math.min(o,t))}function h(e,o){if(o){let o=Math.floor(t.random(-1*e,e+1))/2;return new d(o,o,o)}switch(ue){case L:let o=Math.floor(t.random(-1*e,e+1))/2,n=Math.floor(t.random(-1*e,e+1))/2,f=Math.floor(t.random(-1*e,e+1))/2;return new d(o,n,f);case j:let r=Math.round(t.random(-1*te,te)/2),a=Math.round(t.random(-1*ne,ne)/2),l=Math.round(t.random(-1*fe,fe)/2),s=Math.sign(r),c=Math.sign(a),h=Math.sign(l),i="hsl("+(r=Math.abs(r))+","+(a=Math.abs(a))+"%,"+(l=Math.abs(l))+"%)";return tmpColor=t.color(i),hslR=tmpColor.levels[0]*s,hslG=tmpColor.levels[1]*c,hslB=tmpColor.levels[2]*h,new d(hslR,hslG,hslB)}}function i(e){e.red,e.green,b=e.blue;let o=t.color(e.red,e.green,e.blue),n=t.hue(o),f=t.lightness(o);t.colorMode(t.HSL,255);let r=t.color(n,5,f);return t.colorMode(t.RGB,255),new d(r.levels[0],r.levels[1],r.levels[2])}function u(e){let o=Math.floor(t.random(0,H.length)),n=H[o];return e?i(n):n}function m(e,o){let n=Math.floor(e/o),f=[];for(var r=0;r<o;r++){let a=0;0==f.length?(a=t.random(Math.floor(n/2),n),f.push(a)):(a=t.random(Math.floor(n/2),n)+f[f.length-1],f.push(a));let l=o-(r+1);l>0&&(n=Math.floor((e-a)/l))}return f}const g=2,w=12,M=2,C=17,y=2,p=5,v=2,x=5,N=2,B=8,P=Math.floor(1e3/15-5),S=5,A=100,q=60,R=5,T=3,E=.5,G=5,z=2,_=8,I=5,O=5,k=5,L="RGB",j="HSL",H=["#ffb8ff","#ebc7ea","#ff91ff","#e2ace1","#fe63ff","#da91d8","#f800fc","#ce74cd","#c700cd","#a55ca6","#96009f","#7c447f","#ffb5ea","#e9c3dd","#ff8edf","#e0a7cd","#ff5fd4","#d78abe","#ff00c8","#d16fb0","#cd009d","#a7578b","#9c0073","#7e4066","#ffb4d4","#e8c1d1","#ff8cbf","#dea4bb","#ff5eaa","#d587a6","#ff0596","#ce6b93","#ce006f","#a65471","#9e004b","#7e3e50","#ffb1a5","#fd8878","#d99e94","#f55a49","#ca7e72","#ea0000","#ba5e51","#be0000","#930000","#743830","#ffb9a8","#ff947d","#dda79a","#ff6a4e","#d48a7b","#fe3100","#cc6f5d","#ce0000","#9f0000","#7d3d35","#ffcfaf","#ffb685","#e5c0a8","#ff9c57","#deac8c","#ff8005","#d79871","#cc5100","#a86c52","#991d00","#ffe2b6","#ffd290","#edd7b7","#ffc265","#e7c99f","#ffb224","#e2bc87","#c87e00","#ae8960","#ffebb7","#ffe090","#f1e2bc","#ffd561","#ecd8a5","#ffc900","#e8ce8d","#b19868","#fff5be","#fff09b","#f6efc7","#ffe972","#f3e9b3","#ffe335","#f0e49f","#b5a971","#fefecf","#fefdb4","#fbfbd7","#fffc98","#faf9ca","#fffa77","#f8f7bc","#b9b87f","#c4fb69","#90f24a","#00fc92","#4beed4","#7aecad","#8ae5d3","#bff9ff","#d7f3f6","#9af5fe","#c2edf1","#6cf1fe","#ade6ec","#01edfd","#97e0e7","#00b4c4","#72abb2","#007e8e","#4e777f","#b9ecff","#cfe7f1","#92e2ff","#b6dcea","#64d7ff","#9dd0e3","#00ccff","#84c4dd","#0099ca","#6394ac","#006998","#43667d","#b1ddff","#c5daeb","#88cbff","#a8c8e1","#5ab9ff","#8bb6d8","#00a6fe","#6ea4cf","#007ace","#517ba3","#004fa0","#35537a","#a9cfff","#bbcee6","#7db7ff","#9ab6da","#4f9dff","#7a9fcf","#0181fb","#5987c1","#0059d0","#3f629a","#0030a7","#264076","#99bdff","#abbdde","#689aff","#849ecf","#3773ff","#5e7ec1","#0041ff","#395fb3","#0000db","#204192","#1100b7","#1f367a","#a9bbff","#b4bddf","#8197ff","#909dd1","#5e6fff","#6e7ec2","#443bfe","#4f5eb4","#3200d9","#364294","#2800b5","#2c367a","#b3baff","#b9bee0","#9195ff","#999dd2","#736dff","#7a7ec4","#5c38ff","#5e5fb7","#4600d9","#444496","#3500b4","#34367b","#c4b9ff","#c4bfe2","#a994ff","#a79fd4","#916cff","#8d81c7","#7c38fd","#7462b9","#6000d6","#574697","#4600af","#40377a","#e3b9ff","#d8c3e6","#d493ff","#c4a5da","#c66aff","#b188cf","#b732ff","#9f6bc4","#9000d4","#7b4e9f","#6b00a9","#5c3b7c","#f7b9ff","#e5c6e9","#f093ff","#d8aadf","#e868ff","#ca8ed5","#df26fd","#bc71ca","#b200cf","#9556a2","#8500a2","#6f407d","#B7B7B8","#919191","#656767","#353838","#000000","#130113","#11010a","#160101","#1d0b01","#130b01","#110d01","#010b0a","#041313","#010e16","#01040e","#070416","#0b0413","#130418"].map(e=>(function(e){let o=t.color(e);return new d(o.levels[0],o.levels[1],o.levels[2])})(e)),U=Math.min(e,o),F=U,X=720,D=720,J=U/X,K=Math.ceil(J),Q=new Array,V=new a;let W=new class{constructor(e,o){this.width=e,this.height=o,this.totalPixels=e*o,this.values=new Array(e);for(var t=0;t<e;t++){let e=new Array(o);for(var n=0;n<o;n++)e[n]=new s;this.values[t]=e}}refreshNodes(){this.allCoordinates().forEach(e=>this.getNode(e).refreshNode())}allCoordinates(){const e=new Array(this.width*this.height);let o=0;for(var t=0;t<this.width;t++)for(var n=0;n<this.height;n++)e[o]=new l(t,n),o+=1;return e}getNode(e){return this.isCoordinateInBounds(e)?this.values[e.x][e.y]:null}randomUnmutatedNeighbors(e,o,n,f){const r=[];[new l(-1,1),new l(0,1),new l(1,1),new l(1,0),new l(1,-1),new l(0,-1),new l(-1,-1),new l(-1,0)].forEach(o=>{const t=new l(e.x+o.x,e.y+o.y),n=this.getNode(t);n&&n.unmutated&&(f&&(n.potentialOrphan=!0),r.push(t))});const a=Math.floor(t.random(o,n+1));return function(e,o){if(o>e.length)return e;if(o<0)return[];let n=new Set(e),f=new Array;for(;f.length<o;){let e=t.random(Array.from(n));f.push(e),n.delete(e)}return f}(r,a)}findAdjacentColor(e){const o=[];return[new l(-1,1),new l(0,1),new l(1,1),new l(1,0),new l(1,-1),new l(0,-1),new l(-1,-1),new l(-1,0)].forEach(t=>{const n=new l(e.x+t.x,e.y+t.y),f=this.getNode(n);f&&0==f.unmutated&&o.push(n)}),o.length?this.getNode(t.random(o)).myColor:null}isCoordinateInBounds(e){return e.x>=0&&e.x<this.width&&e.y>=0&&e.y<this.height}}(X,D),Y=!1,Z=!1,$=!1,ee=0,oe=5,te=7,ne=7,fe=7,re=100,ae=!1,le=!1,de=new a,se=0,ce=0,he=0,ie=null,ue=j,be=!1,me=[],ge=[],we=[];t.setup=function(){t.noStroke(),t.noSmooth(),t.randomSeed(r),t.frameRate(15),t.createCanvas(U,F),Ce()};let Me=!0;function Ce(){const e=Math.floor(t.random(1,S+1));se=e;for(var o=0;o<e;o++){const e=new l(Math.floor(t.random(0,X)),Math.floor(t.random(0,D)));Q.push(e);const o=u(le);W.getNode(e).updateColor(o),Me&&(Me=!1,t.background(t.color(o.red,o.green,o.blue)))}oe=Math.floor(t.random(g,w+1)),te=Math.floor(t.random(M,C+1)),ne=Math.floor(t.random(y,p+1)),fe=Math.floor(t.random(v,x+1)),re=Math.floor(t.random(q,A+1));const n=10*R,a=10*T,d=10*E;ae=!1,monochromaticBase=!1,Math.floor(t.random(1,1001))<=d?(le=!0,ae=!0):Math.floor(t.random(1,1001))<=n?ae=!0:Math.floor(t.random(1,1001))<=a&&(le=!0);const s=10*G;ue=Math.floor(t.random(1,1001))<=s?L:j;const c=10*I,h=10*O,i=10*k;be=!1,Math.floor(t.random(1,1001))<=c&&(ge=m(re,Math.floor(t.random(z,_+1)))),Math.floor(t.random(1,1001))<=h&&(ae=!1,me=m(re,Math.floor(t.random(z,_+1)))),Math.floor(t.random(1,1001))<=i&&(we=m(re,Math.floor(t.random(z,_+1)))),f&&(console.log("Seed: "+r),console.log("Start points: "+e),console.log("R Shift: "+oe),console.log("Completion: "+re),console.log("Mono growth: "+ae),console.log("Mono base: "+le),console.log("Max growth: "+B))}t.draw=function(){he=t.millis();let e=!1;for(let o=0;o<1;o++){const o=V.dequeue();for(;o&&o.size>0;){let n=o.dequeue();const f=W.getNode(n);t.fill(t.color(f.myColor.red,f.myColor.green,f.myColor.blue)),t.rect(Math.round(n.x*J),Math.round(n.y*J),K,K),f.waitingToBePainted=!1,e=!0}}e&&t.updatePixels(),Y&&0==V.size&&(Z=!0),Z&&!$?($=!0,function(){for(var e=0;e<W.width;e++)for(var o=0;o<W.height;o++){const t=new l(e,o),n=W.getNode(t);if(n.unmutated&&n.potentialOrphan){const e=W.findAdjacentColor(t);e&&(n.addColors(e,h(oe,ae)),de.enqueue(t))}}de.size>0&&(V.enqueue(de),de=new a)}()):Z&&$&&(t.noLoop(),n&&t.saveCanvas("color_growth_seed-"+r,"png")),Y||function(){if(Y)return;for(;Q.length>0;){const e=Math.floor(t.random(0,Q.length)),o=Q[e];ie=o,Q.splice(e,1);const n=W.getNode(o),f=n.mutateColor(oe,ae);n.waitingToBePainted||(n.waitingToBePainted=!0,de.enqueue(o)),se-=1;const r=(ee+=1)/W.totalPixels*100;let d=re-r<5;const s=W.randomUnmutatedNeighbors(o,N,B,!d);s.forEach(e=>{Q.push(e);const t=new l(2*e.x-o.x,2*e.y-o.y),n=W.getNode(e);W.isCoordinateInBounds(t)&&0==W.getNode(t).unmutated?n.blendColor(f,W.getNode(t).myColor):n.updateColor(f),n.waitingToBePainted||(n.waitingToBePainted=!0,de.enqueue(e)),ce+=1}),se<=0&&(V.enqueue(de),de=new a,se=ce,ce=0);let c=t.millis()-he;if(c>P)return;if(me.length>0&&r>=me[0]&&(me.shift(),be=!be),ge.length>0&&r>=ge[0])switch(ge.shift(),ue){case L:ue=j;break;case j:ue=L}if(we.length>0&&r>=we[0]&&(we.shift(),ae=!ae),r>=re)return void(Y=!0)}const e=ee/W.totalPixels*100;re-e<1?Y=!0:ie&&Q.push(ie)}()},t.mousePressed=function(){Z&&$&&(W.refreshNodes(),Y=!1,Z=!1,$=!1,ee=0,Q.splice(0,Q.length),Ce(),t.loop())}},r]},currentP5=null,currentSeed=null;function startNewRender(e,o,t){const n=Math.floor(o),f=Math.floor(e);currentP5&&currentP5.remove();const[r,a]=colorGrowth(f,n,t,!1,!0);currentSeed=a,currentP5=new p5(r,"container")}function saveImage(){currentP5&&currentSeed&&currentP5.saveCanvas("color_growth_seed-"+currentSeed,"png")}